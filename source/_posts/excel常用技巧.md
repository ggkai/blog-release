---
title: excel常用技巧
date: 2018-11-18 11:17:19
tags: 工作
---
之前做excel顶多做个下拉菜单，合并单元格，再搞个筛选过滤，差不多就是我会的excel高级技能了，虽然很早就听说精通excel，很有用，很牛，工作中用得比较少，也就没什么动力学习。刚好，最近工作需要用excel做一些简单的数据处理和统计，遇到了一些问题，在网上找到解决方法后，就顺便做了一下笔记，方便以后在女朋友面前吹吹牛。
<!-- more -->
# 数据处理
### 分列  
分列功能可以将某一列按照特定规则拆分，比如按照“，”逗号对单元格进行拆分

### 空值填充  
第一步：找到空行。编辑>查找>定位条件>空值  
第二步：数字填充。输入填充内容>Ctrl+Enter（在编辑状态）

### 数据去重  
数据>删除重复项>选择列

### 公式应用到一列
- 方法一：选择单元格右下角>下拉填充
- 方法二：编辑>填充>向下填充（按照首行规则进行填充）
- 方法三：选择单元格>点击fx框/F2进入编辑状态>Ctrl+Enter（公式的单元格必须在四角，可向行列应用）
- 方法四：选择一列>Ctrl+D（把第一行，往下垂直应用，同一个公式）
- 或者：选中单元格>输入公式/内容>Ctrl+Enter（将公式应用到所有单元格）

### 求标准差  
stdevpa求总体样本的标准差

### 将文本转换成数值
- 方法一：选择，点击黄色感叹号，转换为数字
- 方法二：数据>分列>下一步>完成

### 千分位符号  
选择单元格>右键，选择设置单元格格式>数字>数值>使用千位分隔符，可设置小数位数为0

### 文本转超链接  
=HYPERLINK(A1,"显示文字")。如果HYPERLINK函数的链接指定本地路径，可以打开本地指定文件夹    
注意：暂时不知道怎么样覆盖原始文本，只能暂时隐藏原始文本，仅显示超链接

### 在原始列上进行计算  
复制数字>选择原列的数据>选择性粘贴>选择乘法，即可

### 多个excel合并多个sheet  
新建文件夹>需要合并的excel复制到该文档目录下>新建excel>sheet表>右键>查看代码....执行代码  
[参考](https://jingyan.baidu.com/article/6181c3e0bd6274152ef1531e.html)

### 多个sheet合并一个sheet  
新建sheet表>sheet右键>查看代码>进入micsoft excel对象，选择当前sheet表>visic basic编辑器>输入代码，参考链接>执行  
[参考：验证有效](https://jingyan.baidu.com/article/19020a0ad8080d529d28422a.html)

### 多个excel合并一个sheet  
数据>新建查询>选择【从文件】>选择【从文件夹】>输入文件路径，选择【合并和加载】（excel文件复制到一个文件夹下）  
注意：未经过验证，mac版本的wps、excel都没有新建查询这个功能

# 数据透视表
### 多层级分类汇总  
数据透视表的主要功能是将数据聚合，按照各字段进行sum( )，count( )的运算，实现数据快速分类汇总、排序查看。聚合功能有一点类似SQL中的gorupby，python中的pandas.pivot_table( )。

### 实现多层级  
在列标签/行标签中加入多个数据字段，实现多层级，可以展开/折叠进行查看

### 实现降序、升序排列  
选择按照列标签和行标签进行排序
1个字段，可以进行计数统计，按照计数进行排序

### 删除数据透视表  
选择数据透视表单元格>数据透视分析选项卡>选择>整个数据透视表>删除

### 数据联动  
按字段对数据进行联动，实现多层级类别筛选过滤，数据统计的功能，举例查看什么人人在什么休假类型上休了多少天。  
选中数据透视表任意单元格>数据透视分析选项卡>插入切片器>选择需要联动的字段

### 去重计数  
注意excel的mac版本，没有非重复计数的功能
- 方法一：创建数据透视表>勾选“将此数据添加到数据模型”>透视表生成器>值字段设置>非重复计数
- 方法二：先去重，再统计

### 数据列按日期组合  
按日期汇总，比如一个月汇总数据。
透视表时间行标签>创建组/>选择月组合>确定

### 数据列数值分段组合  
按区间进行汇总，比如订单金额0-1000之间。  
透视表数值列标签>创建组/分组选择，分组字段>选择开始、结束、步长>

### 计算字段  
举例，按照地区计算公司利润，计算利润=销售额-成本  
选择数据透视表的值>透视表分析>字段、项目和集>计算字段>插入计算字段

### 全额累加  
比如单月1月=10，2月=20，3月=30，累加即为1月=10，2月=30，3月=60，按某一个字段汇总，选择时间字段

### 按月拆分多个工作sheet表  
利用数据透视表，把数据拆分为多个工作表。举例，把数据按月拆分不同的工作表，按地区拆分不同的表。  
数据透视分析>添加筛选器>选择数据透视表单元格>选项>显示报表筛选页>分页显示，选择字段>确定，按照筛选器类别，生成多个sheet表  
注意：需要有筛选器

# 图表可视化
### 按照目的分类  
- 比较：进行分类比较，一般选择柱状图，时间连续一般选择曲线图，多维度的比较-般选择雷达图
- 分布：在不同区间的分布情况，一般选择直方图
- 关系：两个因素的相关关系，一般选择散点图
- 构成：进行成分比重分析，一般选择饼状图，随时间变化的比重分析，一般选择堆积面积图、堆积柱状图

### 多系列柱状图  
一列表示一个系列，一行多列表示多个系列。  
选择数据>系列>输入名称，可以改系列名称

### 复合饼图  
插入>饼图，选择复合饼图>设置数据系列格式>设置第二绘图区的值，即第二层饼图有几个数，从后往前算  
注意：把第二层饼图的数据放在最后

### 双层饼图  
利用次坐标轴做双层饼图  
选择第一层数据>插入饼图>选择数据源>添加系列>选择Y值区域，即第二层数据>选择分类轴标签,即第二层分类>设置数据系列格式>选择次坐标轴>往外拉动饼图缩小>逐块移动饼图的位置>添加数据标签>设置数据标签格式，选择类别名称、值等

### 三层饼图  
利用圆环图使用添加多个系列做多层圆环图/多层饼图  
选择第一层数据>插入圆环图>选择数据源>添加系列>选择数据和分类>添加多个系列>选择某一层，更改图表类型>选择饼图

# 常用技巧
### 选择非空单元格  
cmd+shift+方向箭头

### 找到空行
- 方法一：数据>筛选>下拉列表中选择“空白” 
- 方法二：编辑>查找>定位条件>空值 

### 单元格出现某个关键词次数  
通配符，*任意多个字符，？任意一个字符  
=COUNTIF(A1:A5,"关键词")等于关键词  
=COUNTIF(A1,"\*关键词\*")包括关键词

### 判断单元格是否包含关键字  
=IF(COUNTIF(A1,"\*关键字\*"),"包含","不包括")包含显示"包含"，不包含显示“不包含”  
=IF(COUNTIF(A1,"\*关键字\*")=1,"包含","不包括")等于1表示，出现1次关键词

### 输入提醒  
通过excel文件批量上传数据时，往往对输入有格式上的要求，有个输入提醒可以避免出错  
验证>输入数据>标题+描述

### 自定义下拉菜单  
数据有效性是一种约束，针对单元格限制其输入，让其只能输入固定几个值。  
数据>有效性/验证>设置>选择允许“列表”>勾选“提供下拉箭头”>源输入选项，英文逗号分隔  
注意：wps中有一个插入下拉菜单的单独功能

### 按照条件求和  
=Sumif(条件区域，求和条件，实际求和区域)  
参数sum_range（实际求和区域）可以不填，表示对条件区域复合条件的进行求和

### 计算某个类别的出现次数  
数据>分类汇总>计数

### 多列排序  
如果一列出分类，一列是数字，排序时需要选择两列，否则一列的顺序变了，另外一列的顺序没变，导致数据顺序错开，谨慎对一列进行排序。